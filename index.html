<!DOCTYPE html>
<html>
  <head>
    <title>Puzzle Game - Login</title>
    <link rel="stylesheet" href="index.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <div id="login-form">
      <img src="images/user-icon.png" />
      <h1>Login Now</h1>
      <form>
        <input
          type="email"
          placeholder="Enter your email"
          class="login-email"
        />
        <input
          type="password"
          placeholder="Enter your password"
          class="login-password"
        /><br /><br />
        <button class="login">Login</button><br />
      </form>
      <p class="or">OR</p>
      <button onclick="signup()" class="sign">Signup Now</button>
    </div>
    <script>
      function validate() {
        let email = document.querySelector(".login-email");
        let password = document.querySelector(".login-password");
        let btn = document.querySelector(".login");
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          if (email.value == "" || password.value == "") {
            alert("Fields cannot be empty!");
          } else {
            var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
            if (email.value.match(mailformat)) {
              const loginEmail = email.value;
              const loginPass = password.value;
              if (localStorage.getItem(email.value)) {
                const loginDeets = JSON.parse(
                  localStorage.getItem(email.value)
                );
                if (
                  loginEmail == email.value &&
                  loginPass == loginDeets.password
                ) {
                  window.location.href = "puzzle-game.html";
                } else {
                  alert("You need to sign in First!");
                }
              } else {
                alert("You need to sign in First!");
              }
            } else {
              alert("You have entered an invalid email address!");

              return false;
            }
          }
        });
      }

      validate();
      function signup() {
        location.href = "signup.html";
      }
    </script>
  </body>
</html>
